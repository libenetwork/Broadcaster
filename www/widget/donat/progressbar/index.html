<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Progressbar</title>
  <script src="../../../js/communicator.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
    <script type="application/javascript" src="../../../js/anime.min.js"></script>
    <link rel = "stylesheet" href="../../../css/progressbar.css">
</head>
<body>

<div class="badge">
    <div class="tittle">
        <div class = "starttext">
        <div id = "tittle">Трошки позбираєм</div>

        </div>
        <div class = "endtext">
            <div id = "amount">Зібрано 0%
            </div>
        </div>

    </div>

<div class="progress">
    <div class="skill" style="width: 0%">0₴</div>
</div>
    <div class = "indicator">
        <div id="start">
            0₴
        </div>
        <div id = "end">
            350₴
        </div>
    </div>
</div>
<script>
    var progressbar = document.getElementsByClassName("skill")[0];
    if (Number(progressbar.style.width.split('%')[0]) < 5){
        progressbar.style.visibility = "hidden";
    }else{
        progressbar.style.visibility = "visible";
    }
  bc.onmessage = (e) => {
        var amount = 0;
      console.log(e.data);
      var progressbar = document.getElementsByClassName("skill")[0];
        var obj = JSON.parse(e.data);
        console.log(obj.amount);
        amount = amount + obj.amount;
        if (amount/350 < 1) {
            var progress = amount / 350 * 100 + "%";
        }
        anime({
            target: '.skill',
            width: progress
        });
      if (Number(progressbar.style.width.split('%')[0]) < 5){
          progressbar.style.visibility = "hidden";
      }else{
          progressbar.style.visibility = "visible";
      }
  };

</script>
</body>
</html>